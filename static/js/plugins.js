(function(e){"use strict";e.fn.findFirstImage=function(){return this.first().find("img").andSelf().filter("img").first()};var t={defaults:{animation:"horizontal-push",animationSpeed:600,timer:true,advanceSpeed:4e3,pauseOnHover:false,startClockOnMouseOut:false,startClockOnMouseOutAfter:1e3,directionalNav:true,directionalNavRightText:"Right",directionalNavLeftText:"Left",captions:true,captionAnimation:"fade",captionAnimationSpeed:600,resetTimerOnClick:false,bullets:false,bulletThumbs:false,bulletThumbLocation:"",afterSlideChange:e.noop,afterLoadComplete:e.noop,fluid:true,centerBullets:true},activeSlide:0,numberSlides:0,orbitWidth:null,orbitHeight:null,locked:null,timerRunning:null,degrees:0,wrapperHTML:'<div class="orbit-wrapper" />',timerHTML:'<div class="timer"><span class="mask"><span class="rotator"></span></span><span class="pause"></span></div>',captionHTML:'<div class="orbit-caption"></div>',directionalNavHTML:'<div class="slider-nav"><span class="right"></span><span class="left"></span></div>',bulletHTML:'<ul class="orbit-bullets"></ul>',init:function(t,n){var r,i=0,s=this;this.clickTimer=e.proxy(this.clickTimer,this);this.addBullet=e.proxy(this.addBullet,this);this.resetAndUnlock=e.proxy(this.resetAndUnlock,this);this.stopClock=e.proxy(this.stopClock,this);this.startTimerAfterMouseLeave=e.proxy(this.startTimerAfterMouseLeave,this);this.clearClockMouseLeaveTimer=e.proxy(this.clearClockMouseLeaveTimer,this);this.rotateTimer=e.proxy(this.rotateTimer,this);this.options=e.extend({},this.defaults,n);if(this.options.timer==="false")this.options.timer=false;if(this.options.captions==="false")this.options.captions=false;if(this.options.directionalNav==="false")this.options.directionalNav=false;this.$element=e(t);this.$wrapper=this.$element.wrap(this.wrapperHTML).parent();this.$slides=this.$element.children("img, a, div");this.$element.bind("orbit.next",function(){s.shift("next")});this.$element.bind("orbit.prev",function(){s.shift("prev")});this.$element.bind("orbit.goto",function(e,t){s.shift(t)});this.$element.bind("orbit.start",function(e,t){s.startClock()});this.$element.bind("orbit.stop",function(e,t){s.stopClock()});r=this.$slides.filter("img");if(r.length===0){this.loaded()}else{r.bind("imageready",function(){i+=1;if(i===r.length){s.loaded()}})}},loaded:function(){this.$element.addClass("orbit").css({width:"1px",height:"1px"});this.$slides.addClass("orbit-slide");this.setDimentionsFromLargestSlide();this.updateOptionsIfOnlyOneSlide();this.setupFirstSlide();if(this.options.timer){this.setupTimer();this.startClock()}if(this.options.captions){this.setupCaptions()}if(this.options.directionalNav){this.setupDirectionalNav()}if(this.options.bullets){this.setupBulletNav();this.setActiveBullet()}this.options.afterLoadComplete.call(this)},currentSlide:function(){return this.$slides.eq(this.activeSlide)},setDimentionsFromLargestSlide:function(){var t=this,n;t.$element.add(t.$wrapper).width(this.$slides.first().outerWidth());t.$element.add(t.$wrapper).height(this.$slides.first().height());t.orbitWidth=this.$slides.first().outerWidth();t.orbitHeight=this.$slides.first().height();n=this.$slides.first().findFirstImage().clone();this.$slides.each(function(){var r=e(this),i=r.outerWidth(),s=r.height();if(i>t.$element.outerWidth()){t.$element.add(t.$wrapper).width(i);t.orbitWidth=t.$element.outerWidth()}if(s>t.$element.height()){t.$element.add(t.$wrapper).height(s);t.orbitHeight=t.$element.height();n=e(this).findFirstImage().clone()}t.numberSlides+=1});if(this.options.fluid){if(typeof this.options.fluid==="string"){n=e('<img src="http://placehold.it/'+this.options.fluid+'" />')}t.$element.prepend(n);n.addClass("fluid-placeholder");t.$element.add(t.$wrapper).css({width:"inherit"});t.$element.add(t.$wrapper).css({height:"inherit"});e(window).bind("resize",function(){t.orbitWidth=t.$element.outerWidth();t.orbitHeight=t.$element.height()})}},lock:function(){this.locked=true},unlock:function(){this.locked=false},updateOptionsIfOnlyOneSlide:function(){if(this.$slides.length===1){this.options.directionalNav=false;this.options.timer=false;this.options.bullets=false}},setupFirstSlide:function(){var e=this;this.$slides.first().css({"z-index":3}).fadeIn(function(){e.$slides.css({display:"block"})})},startClock:function(){var e=this;if(!this.options.timer){return false}if(this.$timer.is(":hidden")){this.clock=setInterval(function(){e.$element.trigger("orbit.next")},this.options.advanceSpeed)}else{this.timerRunning=true;this.$pause.removeClass("active");this.clock=setInterval(this.rotateTimer,this.options.advanceSpeed/180,false)}},rotateTimer:function(e){var t="rotate("+this.degrees+"deg)";this.degrees+=2;this.$rotator.css({"-webkit-transform":t,"-moz-transform":t,"-o-transform":t,"-ms-transform":t});if(this.degrees>180){this.$rotator.addClass("move");this.$mask.addClass("move")}if(this.degrees>360||e){this.$rotator.removeClass("move");this.$mask.removeClass("move");this.degrees=0;this.$element.trigger("orbit.next")}},stopClock:function(){if(!this.options.timer){return false}else{this.timerRunning=false;clearInterval(this.clock);this.$pause.addClass("active")}},setupTimer:function(){this.$timer=e(this.timerHTML);this.$wrapper.append(this.$timer);this.$rotator=this.$timer.find(".rotator");this.$mask=this.$timer.find(".mask");this.$pause=this.$timer.find(".pause");this.$timer.click(this.clickTimer);if(this.options.startClockOnMouseOut){this.$wrapper.mouseleave(this.startTimerAfterMouseLeave);this.$wrapper.mouseenter(this.clearClockMouseLeaveTimer)}if(this.options.pauseOnHover){this.$wrapper.mouseenter(this.stopClock)}},startTimerAfterMouseLeave:function(){var e=this;this.outTimer=setTimeout(function(){if(!e.timerRunning){e.startClock()}},this.options.startClockOnMouseOutAfter)},clearClockMouseLeaveTimer:function(){clearTimeout(this.outTimer)},clickTimer:function(){if(!this.timerRunning){this.startClock()}else{this.stopClock()}},setupCaptions:function(){this.$caption=e(this.captionHTML);this.$wrapper.append(this.$caption);this.setCaption()},setCaption:function(){var t=this.currentSlide().attr("data-caption"),n;if(!this.options.captions){return false}if(t){if(e.trim(e(t).text()).length<1){return false}n=e(t).html();this.$caption.attr("id",t).html(n);switch(this.options.captionAnimation){case"none":this.$caption.show();break;case"fade":this.$caption.fadeIn(this.options.captionAnimationSpeed);break;case"slideOpen":this.$caption.slideDown(this.options.captionAnimationSpeed);break}}else{switch(this.options.captionAnimation){case"none":this.$caption.hide();break;case"fade":this.$caption.fadeOut(this.options.captionAnimationSpeed);break;case"slideOpen":this.$caption.slideUp(this.options.captionAnimationSpeed);break}}},setupDirectionalNav:function(){var t=this,n=e(this.directionalNavHTML);n.find(".right").html(this.options.directionalNavRightText);n.find(".left").html(this.options.directionalNavLeftText);this.$wrapper.append(n);this.$wrapper.find(".left").click(function(){t.stopClock();if(t.options.resetTimerOnClick){t.rotateTimer(true);t.startClock()}t.$element.trigger("orbit.prev")});this.$wrapper.find(".right").click(function(){t.stopClock();if(t.options.resetTimerOnClick){t.rotateTimer(true);t.startClock()}t.$element.trigger("orbit.next")})},setupBulletNav:function(){this.$bullets=e(this.bulletHTML);this.$wrapper.append(this.$bullets);this.$slides.each(this.addBullet);this.$element.addClass("with-bullets");if(this.options.centerBullets)this.$bullets.css("margin-left",-this.$bullets.outerWidth()/2)},addBullet:function(t,n){var r=t+1,i=e("<li>"+r+"</li>"),s,o=this;if(this.options.bulletThumbs){s=e(n).attr("data-thumb");if(s){i.addClass("has-thumb").css({background:"url("+this.options.bulletThumbLocation+s+") no-repeat"});}}this.$bullets.append(i);i.data("index",t);i.click(function(){o.stopClock();if(o.options.resetTimerOnClick){o.rotateTimer(true);o.startClock()}o.$element.trigger("orbit.goto",[i.data("index")])})},setActiveBullet:function(){if(!this.options.bullets){return false}else{this.$bullets.find("li").removeClass("active").eq(this.activeSlide).addClass("active")}},resetAndUnlock:function(){this.$slides.eq(this.prevActiveSlide).css({"z-index":1});this.unlock();this.options.afterSlideChange.call(this,this.$slides.eq(this.prevActiveSlide),this.$slides.eq(this.activeSlide))},shift:function(e){var t=e;this.prevActiveSlide=this.activeSlide;if(this.prevActiveSlide==t){return false}if(this.$slides.length=="1"){return false}if(!this.locked){this.lock();if(e=="next"){this.activeSlide++;if(this.activeSlide==this.numberSlides){this.activeSlide=0}}else if(e=="prev"){this.activeSlide--;if(this.activeSlide<0){this.activeSlide=this.numberSlides-1}}else{this.activeSlide=e;if(this.prevActiveSlide<this.activeSlide){t="next"}else if(this.prevActiveSlide>this.activeSlide){t="prev"}}this.setActiveBullet();this.$slides.eq(this.prevActiveSlide).css({"z-index":2});if(this.options.animation=="fade"){this.$slides.eq(this.activeSlide).css({opacity:0,"z-index":3}).animate({opacity:1},this.options.animationSpeed,this.resetAndUnlock)}if(this.options.animation=="horizontal-slide"){if(t=="next"){this.$slides.eq(this.activeSlide).css({left:this.orbitWidth,"z-index":3}).animate({left:0},this.options.animationSpeed,this.resetAndUnlock)}if(t=="prev"){this.$slides.eq(this.activeSlide).css({left:-this.orbitWidth,"z-index":3}).animate({left:0},this.options.animationSpeed,this.resetAndUnlock)}}if(this.options.animation=="vertical-slide"){if(t=="prev"){this.$slides.eq(this.activeSlide).css({top:this.orbitHeight,"z-index":3}).animate({top:0},this.options.animationSpeed,this.resetAndUnlock)}if(t=="next"){this.$slides.eq(this.activeSlide).css({top:-this.orbitHeight,"z-index":3}).animate({top:0},this.options.animationSpeed,this.resetAndUnlock)}}if(this.options.animation=="horizontal-push"){if(t=="next"){this.$slides.eq(this.activeSlide).css({left:this.orbitWidth,"z-index":3}).animate({left:0},this.options.animationSpeed,this.resetAndUnlock);this.$slides.eq(this.prevActiveSlide).animate({left:-this.orbitWidth},this.options.animationSpeed)}if(t=="prev"){this.$slides.eq(this.activeSlide).css({left:-this.orbitWidth,"z-index":3}).animate({left:0},this.options.animationSpeed,this.resetAndUnlock);this.$slides.eq(this.prevActiveSlide).animate({left:this.orbitWidth},this.options.animationSpeed)}}if(this.options.animation=="vertical-push"){if(t=="next"){this.$slides.eq(this.activeSlide).css({top:-this.orbitHeight,"z-index":3}).animate({top:0},this.options.animationSpeed,this.resetAndUnlock);this.$slides.eq(this.prevActiveSlide).animate({top:this.orbitHeight},this.options.animationSpeed)}if(t=="prev"){this.$slides.eq(this.activeSlide).css({top:this.orbitHeight,"z-index":3}).animate({top:0},this.options.animationSpeed,this.resetAndUnlock);this.$slides.eq(this.prevActiveSlide).animate({top:-this.orbitHeight},this.options.animationSpeed)}}this.setCaption()}}};e.fn.orbit=function(n){return this.each(function(){var r=e.extend({},t);r.init(this,n)})}})(jQuery);(function(e){function n(t,n){var r=e(t);r.bind("load.imageready",function(){n.apply(t,arguments);r.unbind("load.imageready")})}var t={};e.event.special.imageready={setup:function(e,n,r){t=e||t},add:function(r){var i=e(this),s;if(this.nodeType===1&&this.tagName.toLowerCase()==="img"&&this.src!==""){if(t.forceLoad){s=i.attr("src");i.attr("src","");n(this,r.handler);i.attr("src",s)}else if(this.complete||this.readyState===4){r.handler.apply(this,arguments)}else{n(this,r.handler)}}},teardown:function(t){e(this).unbind(".imageready")}}})(jQuery)
